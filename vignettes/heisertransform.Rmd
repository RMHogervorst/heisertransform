---
title: "Heiser transform uses"
author: "Roel M Hogervorst"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Vignette Title}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---
```{r, echo=FALSE, eval=FALSE}
A short introduction that explains
    The type of data the package can be used on
    The general purpose of the functions in the package
One or more example analyses with
    A small, real data set
    An explanation of the key functions
    An application of these functions to the data
    A description of the output and how it can be used
```

# Introduction
This package helps in visualizing probability information for 3 predicted classes. 
It transforms three columns of probabilities into xy coordinates. 
Every row in the three columns needs to add up to 1, and be of the numeric type.
The main reason for transformation is to visualize probability information 
from 3 classes into a 2 dimensional space. The endresult will be a triangle.

Here is some example probability information to transform.
```{r}
library(heisertransform)
testdata
```

## Functions 
The package had 2 main functions: CreateVertices, and Prob2Coord.
CreateVertices gives you the coordinates for the corners of the triangle.

```{r}
CreateVertices(testdata, "test1", "test2","test3")
```


```{r}
library(heisertransform)
temp<-CreateVertices(testdata, "test1", "test2","test3",verticeName = F)
plot(temp, main = "Triangle points", pch = 17, col = "red")
```

Prob2Coord will transform the probabilties from every row into coordinates within
the triangle. 

```{r}
Prob2Coord(testdata, "test1", "test2","test3", append = T)
```

```{r}
library(heisertransform)
temp<-CreateVertices(testdata, "test1", "test2","test3",verticeName = F)
plot(temp, main = "Triangle, points, lines", pch = 17, col = "red")
points(Prob2Coord(testdata, "test1", "test2","test3"), col= "darkgreen", pch = 4)
segments(x0 = temp[1,1], y0 = temp[1,2], x1 =temp[2,1], y1 = temp[2,2])
segments(x0 = temp[2,1], y0 = temp[2,2], x1 =temp[3,1], y1 = temp[3,2])
segments(x0 = temp[3,1], y0 = temp[3,2], x1 =temp[1,1], y1 = temp[1,2])
```

## Examples in ggplot2
First a simple plot of the vertices and points.
```{r}
library(ggplot2)
vert<- CreateVertices(testdata, "test1", "test2","test3",verticeName = T)
points<-Prob2Coord(testdata, "test1", "test2","test3", append = T)
ggplot(data = vert, aes(x,y))+geom_point( color = "red") + 
        geom_point(data = points, aes(x,y), colour = "darkgreen")
```

The same plot but with other colours. 

```{r}
ggplot(data = vert, aes(x,y))+geom_point( color = "red") + 
        geom_point(data =Prob2Coord(testdata, "test1", "test2","test3", append = T), aes(x,y, colour = cat))+
        geom_line(data = vert, aes(x,y))+
        geom_segment(data = vert, aes(x = x[1], xend = x[3], y= y[1], yend= y[3]))
```


Custimizations look better when you put them into functions or lists.
All ggplot parts are lists, so let's create lists for lines, corners
 
```{r list}
lines<-list(geom_line(data = vert, aes(x,y), colour = "#122b3e"),
              geom_segment(data = vert, aes(x = x[1], xend = x[3], y= y[1], yend= y[3]), colour = "#122b3e" ))
corners<-list(geom_point(data = vert[1,], aes(x, y),  shape = 17,  size = 5, colour = "#cc0000"),
              geom_point(data = vert[2,], aes(x, y),  shape = 17,  size = 5, stroke = 2, colour = "#ffca00"),
              geom_point(data = vert[3,], aes(x, y),  shape = 17,  size = 5, stroke = 2, colour = "#00b300")
 )
 
text<- list(geom_text(data = vert[1,], aes(x,y, label = "left"), vjust =1.5, hjust = 0, colour = "#cc0000") ,
               geom_text(data = vert[2,], aes(x,y, label = "top"), vjust =0, hjust = 1.5, colour = "#ffca00") ,
               geom_text(data = vert[3,], aes(x,y, label = "right"), vjust =1.5, hjust = 1, colour = "#00b300")
  )
```

Then build the plots, part for part
```{r}
g<-ggplot() +lines +corners + text
g
g+geom_point(data =Prob2Coord(testdata, "test1", "test2","test3", append = T), aes(x,y, colour = cat))
```


The default ggplot theme is distracting, the axes are not really what matters here.
The minimal theme is somewhat better, but it's even better to get rid of all the axis.

```{r}
g+  theme_minimal()
```

It quite easy to create a new theme
```{r}
#creating a new theme
theme_heiser<-theme_grey() + theme(axis.line=element_blank(),
                                    axis.text.x=element_blank(),
                                    axis.text.y=element_blank(),
                                    axis.ticks=element_blank(),
                                    axis.title.x=element_blank(),
                                    axis.title.y=element_blank(),
                                    legend.position="bottom",
                                    panel.background=element_blank(),
                                    panel.border=element_blank(),
                                    panel.grid.major=element_blank(),
                                    panel.grid.minor=element_blank(),
                                    plot.background=element_blank())
```

And then everyting together.
```{r}
g+geom_point(data = points, aes(x,y, colour = cat)) +
          theme_heiser
```
